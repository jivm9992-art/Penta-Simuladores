<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM Afore Banamex - Pentaf√≥n</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        :root {
            --bana-blue: #002D72;
            --bana-red: #DA291C;
            --bana-light-blue: #41B6E6;
            --bg-color: #f4f6f9;
            --text-color: #333;
            --success-green: #7CFC00;
            --warning-yellow: #fcd55b;
            --alert-red: #ff6b6b;
            --cyan-fin: #00bcd4;
            --blue-dtt: #007bff;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-color); margin: 0; padding: 20px; color: var(--text-color); font-size: 14px; }
        
        /* LOGIN */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #002D72; z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .login-box { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); text-align: center; width: 300px; }
        .login-box img { width: 150px; margin-bottom: 20px; }
        .login-box input { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #ddd; border-radius: 5px; font-size: 16px; text-align: center; box-sizing: border-box; }
        .login-btn { background-color: var(--bana-red); color: white; border: none; padding: 12px; width: 100%; border-radius: 5px; font-weight: bold; font-size: 16px; cursor: pointer; transition: 0.3s; }
        .login-btn:hover { background-color: #b00020; }

        /* HEADER */
        header { background-color: white; border-bottom: 4px solid var(--bana-blue); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; border-radius: 5px;}
        .logo-area img { height: 40px; width: auto; }
        .agent-info { font-weight: bold; color: var(--bana-blue); margin-right: 15px; }

        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); min-height: 600px; }

        .nav-buttons { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; padding: 10px; background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .btn-nav { background: white; border: 1px solid var(--bana-blue); color: var(--bana-blue); padding: 8px 15px; font-size: 0.9rem; font-weight: 600; border-radius: 4px; cursor: pointer; transition: all 0.2s; }
        .btn-nav:hover, .btn-nav.active { background-color: var(--bana-blue); color: white; }

        .crm-title { text-align: center; font-size: 1.8rem; color: #000; font-family: 'Times New Roman', serif; margin-bottom: 30px; text-transform: uppercase; letter-spacing: 1px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        
        .interaction-step { background-color: #f8f9fa; padding: 20px; margin-bottom: 20px; border-radius: 5px; border-left: 5px solid transparent; display: none; animation: fadeIn 0.4s ease-in-out; }
        .interaction-step.visible { display: block; border-left-color: var(--bana-blue); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .script-text { font-size: 1rem; line-height: 1.6; color: #212529; margin-bottom: 15px; }
        .highlight { color: var(--bana-blue); font-weight: 700; }

        .radio-group { margin-top: 10px; display: flex; gap: 20px; align-items: center; }
        .radio-group label { font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 5px; }
        input[type="radio"] { accent-color: var(--bana-blue); transform: scale(1.2); }

        .alert-box-red { background-color: var(--alert-red); color: white; padding: 20px; border-radius: 5px; margin: 15px 0; font-weight: bold; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); line-height: 1.5;}
        .alert-box-yellow { background-color: var(--warning-yellow); color: #333; padding: 20px; border-radius: 8px; margin: 15px 0; font-weight: bold; text-align: center; border: 2px solid #e0c040; font-size: 0.95rem; line-height: 1.5; }

        .validation-grid, .tipif-grid { display: grid; grid-template-columns: 200px 1fr; gap: 15px; align-items: center; background-color: #fff; padding: 20px; border: 1px solid #eee; margin-top: 15px; border-radius: 5px; }
        .form-grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px; }
        
        label { font-weight: 600; color: #555; }
        select, textarea, input[type="text"], input[type="date"], input[type="time"], input[type="number"] { padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; width: 100%; font-family: inherit; font-size: 0.95rem; box-sizing: border-box; }
        textarea { resize: vertical; height: 80px; }

        .system-msg { padding: 15px; margin-top: 15px; border-radius: 4px; border: 1px solid #ddd; background-color: white; }
        .msg-end { background-color: #f8d7da; color: #721c24; border-color: #f5c6cb; }
        .msg-info { background-color: #d1ecf1; color: #0c5460; border-color: #bee5eb; }
        
        .huellas-no-msg { background-color: #e8f4fd; border-left: 4px solid #17a2b8; padding: 20px; margin-top: 15px; }
        .instruction-block { background-color: #fff; padding: 15px; border: 1px dashed #999; margin-top: 10px; font-size: 0.9rem; }

        .btn-action { background-color: var(--bana-red); color: white; border: none; padding: 10px 25px; border-radius: 4px; cursor: pointer; margin-top: 15px; font-weight: bold; transition: background 0.2s; }
        .btn-action:hover { background-color: #b00020; }
        
        .btn-save { background-color: var(--bana-blue); color: white; border: none; padding: 15px; border-radius: 4px; cursor: pointer; margin-top: 20px; font-weight: bold; font-size: 1.1rem; width: 100%; transition: background 0.2s; }
        .btn-save:hover { background-color: #001f52; }

        .btn-download { background-color: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; }
        .btn-download:hover { background-color: #218838; }
        
        .agenda-panel { margin-top: 15px; padding: 15px; border: 1px solid #b2dba1; background-color: #dff0d8; border-radius: 5px; display: none; }

        select option { font-weight: bold; }
        .opt-full { background-color: var(--success-green); color: #000; } 
        .opt-dtt { background-color: var(--blue-dtt); color: #fff; } 
        .opt-fin { background-color: var(--cyan-fin); color: #fff; } 
        .opt-red { background-color: var(--alert-red); color: #fff; } 
        .opt-other { background-color: #FFFF00; color: #000; } 

    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-box">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Citibanamex_logo.svg/2560px-Citibanamex_logo.svg.png" alt="Citibanamex">
        <h3 style="color:#002D72;">Acceso a CRM</h3>
        <p>Ingresa tu n√∫mero de empleado para iniciar turno.</p>
        <input type="text" id="empleado-id" placeholder="No. de Empleado" autocomplete="off">
        <button class="login-btn" onclick="iniciarSesion()">INGRESAR</button>
        <p id="login-error" style="color:red; display:none; margin-top:10px;">Ingresa un n√∫mero v√°lido</p>
    </div>
</div>

<div id="main-app" style="display:none;">
    <header>
        <div class="logo-area">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Citibanamex_logo.svg/2560px-Citibanamex_logo.svg.png" alt="Citibanamex">
        </div>
        <div style="display:flex; align-items:center;">
            <span class="agent-info" id="display-agente"></span>
            <button class="btn-download" onclick="descargarExcel()">üíæ Descargar Reporte</button>
        </div>
    </header>

    <div class="container">
        <div class="nav-buttons">
            <button class="btn-nav active" onclick="cargarCRM('enrolamiento')">Enrolamiento</button>
            <button class="btn-nav" onclick="cargarCRM('ppp-dep')">PPP Dependencia</button>
            <button class="btn-nav" onclick="cargarCRM('ppt-trab')">PPT Trabajador</button>
            <button class="btn-nav" onclick="cargarCRM('notiafo')">Notiafo</button>
            <button class="btn-nav" onclick="cargarCRM('portal')">Portal Prospectos</button>
            <button class="btn-nav" onclick="cargarCRM('info')">Info Retiro</button>
            <button class="btn-nav" onclick="cargarCRM('digital')">Digital IN</button>
            <button class="btn-nav" onclick="cargarCRM('confin')">Confirmaci√≥n IN</button>
            <button class="btn-nav" onclick="cargarCRM('confout')">Confirmaci√≥n OUT</button>
            <button class="btn-nav" onclick="cargarCRM('folio')">Folio</button>
        </div>

        <div id="crm-enrolamiento" class="crm-content">
            <h2 class="crm-title">ENROLAMIENTO</h2>
            <div id="enr-step1" class="interaction-step visible">
                <div class="script-text">Buenos D/T/N mi nombre es de <span class="highlight">AFORE BANAMEX</span>, ¬øTengo el gusto con el/la Sr./Srita. Por favor?</div>
                <div class="radio-group"><label><input type="radio" name="enr_r1" onclick="nextStepEnr(1, true)"> S√≠</label><label><input type="radio" name="enr_r1" onclick="nextStepEnr(1, false)"> No</label></div>
                <div id="enr-msg-1-no" class="system-msg msg-info" style="display:none; background-color: #f8f9fa; border:1px solid #ddd; color:#333;">Una disculpa por las molestias, agradezco haya tomado la llamada, que siga pasando un excelente d√≠a/tarde/noche. Mi nombre es () de <strong>AFORE BANAMEX</strong>, hasta luego.</div>
                <button id="enr-btn-tip-1" class="btn-action" style="display:none; background:#555;" onclick="irATipificacion('enr')">Ir a Tipificaci√≥n</button>
            </div>
            <div id="enr-step2" class="interaction-step">
                <div class="script-text">Mucho gusto Sr. / Srita., antes que nada le informo que en <span class="highlight">AFORE BANAMEX</span> sus datos personales est√°n protegidos, puede consultar nuestro aviso de privacidad en www.aforebanamex.com.mx o bien si Usted as√≠ lo desea, en este momento lo puedo transferir para que escuche nuestro Aviso de Privacidad.<br><br><strong>¬øDesea escucharlo?</strong></div>
                <div class="radio-group"><label><input type="radio" name="enr_r2" onclick="nextStepEnr(2, 'si')"> S√≠</label><label><input type="radio" name="enr_r2" onclick="nextStepEnr(2, 'no')"> No</label></div>
                <div id="enr-msg-privacy" class="system-msg msg-info" style="display:none;">[Sistema]: Transfiriendo a IVR de Aviso de Privacidad... (Al terminar, continuar).</div>
            </div>
            <div id="enr-step3" class="interaction-step">
                <div class="script-text">Sr. / Srita., le llam√≥ en seguimiento al tr√°mite de enrolamiento que realiz√≥ con nosotros y queremos confirmar la informaci√≥n.<br><br><strong>¬øPodemos continuar?</strong></div>
                <div class="radio-group"><label><input type="radio" name="enr_r3" onclick="nextStepEnr(3, true)"> S√≠</label><label><input type="radio" name="enr_r3" onclick="nextStepEnr(3, false)"> No</label></div>
                <div id="enr-opciones-container" style="display:none; margin-top:15px; border-top:1px solid #ccc; padding-top:10px;"><label style="font-weight:bold;">Opciones (Raz√≥n del rechazo):</label><select id="enr-opciones-rechazo" onchange="document.getElementById('enr-btn-tip-3').style.display = 'inline-block'"><option value="">SELECCIONE</option><option value="No tengo tiempo en este momento">No tengo tiempo en este momento</option><option value="No tengo tiempo estoy ocupado">No tengo tiempo estoy ocupado</option><option value="No me gusta dar informaci√≥n por tel√©fono">No me gusta dar informaci√≥n por tel√©fono</option><option value="Ya me hab√≠an llamado anteriormente">Ya me hab√≠an llamado anteriormente</option><option value="No me interesa">No me interesa</option><option value="Yo me acerco despu√©s a un care a preguntar">Yo me acerco despu√©s a un care a preguntar</option><option value="Titular Molesto">Titular Molesto</option></select><br><button id="enr-btn-tip-3" class="btn-action" style="display:none; background:#555;" onclick="irATipificacion('enr')">Ir a Tipificaci√≥n</button></div>
            </div>
            <div id="enr-step4" class="interaction-step">
                <div class="script-text">La tranquilidad de nuestros clientes es nuestra prioridad, por esa raz√≥n esta llamada est√° siendo grabada. Teniendo en cuenta que para <span class="highlight">AFORE BANAMEX</span> la calidad en el servicio es muy importante, antes de continuar debo corroborar un dato:<br><strong>¬øPodr√≠a por favor indicarme su nombre completo y/o Curp?</strong></div>
                <div class="validation-grid"><label>Nombre Completo:</label><select id="enr-val-nombre"><option>SELECCIONE</option><option>CORRECTO</option><option>INCORRECTO</option></select><label>N√∫mero Telef√≥nico:</label><select id="enr-val-tel"><option>SELECCIONE</option><option>CORRECTO</option><option>INCORRECTO</option></select><label>CURP:</label><select id="enr-val-curp"><option>SELECCIONE</option><option>CORRECTO</option><option>INCORRECTO</option></select></div>
                <button class="btn-action" onclick="validarDatosEnr()">Confirmar Datos</button>
                <div id="enr-error-val" class="system-msg msg-end" style="display:none;">Error: Debe validar al menos un dato como "CORRECTO".</div>
            </div>
            <div id="enr-step5" class="interaction-step">
                <div class="script-text">Sr./ Sra./ Srita. Tengo en sistema que cuando acudi√≥ al CARE (Centro de Atenci√≥n para el Retiro) a realizar su tr√°mite para su Expediente de Identificaci√≥n Electr√≥nico existieron inconvenientes al realizar la toma de alguna de sus huellas dactilares dentro del proceso queremos confirmar si usted tiene conocimiento.</div>
                <div class="radio-group"><label><input type="radio" name="enr_r5" onclick="nextStepEnr(5, true)"> S√≠</label><label><input type="radio" name="enr_r5" onclick="nextStepEnr(5, false)"> No</label></div>
                <div id="enr-huellas-no" class="huellas-no-msg" style="display:none;"><p><strong>"Nos gustar√≠a identificar si usted sabe s√≠ sus huellas fueron registradas con excepciones..."</strong></p><div class="instruction-block"><ul><li>En caso de que el cliente mantenga su postura... canalizar al CARE.</li><li>En caso de que no recuerde el n√∫mero de huellas... registrar No coincidencia.</li><li>En caso de que el cliente mencione que no tiene excepciones... enviar a CARE.</li></ul></div><button class="btn-action" onclick="nextStepEnr(5, 'continuar')">Continuar al Cierre</button></div>
            </div>
            <div id="enr-step6" class="interaction-step">
                <div class="script-text" style="background-color: #e3f2fd; padding: 15px; border-radius: 5px;"><p><strong>Gracias a esta llamada y a la confirmaci√≥n de sus datos, su tr√°mite de enrolamiento contin√∫a en proceso.</strong></p><p>Le recomendamos que, en caso de haber recibido instrucciones adicionales al acudir al Centro de Atenci√≥n para el Retiro (CARE) por parte de un Asesor Previsional, las siga tal como le fueron indicadas.</p><p>El tiempo de respuesta del tr√°mite es de <strong>5 a 10 d√≠as h√°biles</strong>. Una vez concluido este periodo, podr√° acudir nuevamente al Centro de Atenci√≥n para el Retiro (CARE) para realizar cualquier otro tr√°mite de su inter√©s o dar seguimiento al actual.</p><p>Para cualquier duda sobre su cuenta individual, puede comunicarse a nuestro Centro de Atenci√≥n Telef√≥nica al <strong>55 2262 3673</strong>, de lunes a s√°bado, de 8:00 a. m. a 8:00 p. m., sin costo desde todo el pa√≠s.</p></div><br><button class="btn-action" onclick="irATipificacion('enr')">Finalizar y Tipificar</button>
            </div>
            <div id="enr-step7" class="interaction-step" style="border-left-color: #28a745;">
                <h3 style="color:var(--bana-blue);">TIPIFICACI√ìN ENROLAMIENTO</h3>
                <div class="tipif-grid">
                    <label>Calificaci√≥n:</label><select id="enr-calif"><option>SELECCIONE</option><option>CONTACTO EFECTIVO</option><option>CONTACTO NO EFECTIVO</option></select>
                    <label>Tipificaci√≥n:</label><select id="enr-tipif" onchange="verificarAgenda('enr')"><option value="">SELECCIONE</option><option value="FULL" class="opt-full">FULL - CONTACTO EXITOSO (CONFIRMA EXCEPCIONES)</option><option value="FULL" class="opt-full">FULL - CONTACTO EXITOSO (NO CONFIRMA EXCEPCIONES)</option><option value="DTT" class="opt-dtt">DTT - Cliente no est√° interesado</option><option value="TRU" class="opt-other">TRU - Cuelga llamada</option><option value="OCU" class="opt-other">OCU - Tel√©fono ocupado</option><option value="INT" class="opt-other">INT - Suena de 1 a 5 veces y no responde</option><option value="MED" class="opt-other">MED - Trabajador pide llamar despu√©s</option><option value="NCO" class="opt-other">NCO - Trabajador no se encuentra</option><option value="NCA" class="opt-other">NCA - El apoderado no se encuentra</option><option value="CEL" class="opt-other">CEL - Fuera de servicio & Buz√≥n</option><option value="DNC" class="opt-other">DNC - Datos no coinciden</option><option value="FIN" class="opt-fin">FIN - Finado</option></select>
                    <label>Comentarios:</label><textarea id="enr-coment"></textarea>
                </div>
                <div id="enr-agenda" class="agenda-panel"><h4>üìÖ Agendar (MED)</h4><input type="date" id="enr-date"> <input type="time" id="enr-time"></div>
                <button class="btn-save" onclick="guardarInteraccion('Enrolamiento')">GUARDAR INTERACCI√ìN</button>
            </div>
        </div>

        <div id="crm-ppp-dep" class="crm-content" style="display:none;">
            <h2 class="crm-title">DEPENDENCIA CRM</h2>
            <div id="ppp-step1" class="interaction-step visible">
                <div class="script-text">Buenos D/T/N mi nombre es de <span class="highlight">AFORE BANAMEX</span>, ¬øTengo el gusto con el/la Sr. / Srita. Por favor?</div>
                <div class="radio-group"><label><input type="radio" name="ppp_r1" onclick="nextStepPpp(1, true)"> S√≠</label><label><input type="radio" name="ppp_r1" onclick="nextStepPpp(1, false)"> No</label></div>
                <div class="alert-box-red">! Recuerda que debes conseguir un "SI" textual de confirmaci√≥n por parte del cliente...<br>1. ¬øMe puede confirmar con un "SI" o un "NO" si es usted XXXXXX?</div>
                <div class="alert-box-yellow">¬°Aviso! <br>En <strong>AFORE BANAMEX</strong> sus datos personales est√°n protegidos, consulte el aviso de privacidad en www.aforebanamex.com.mx o si lo prefiere le puedo transferir en este momento.<br><br><strong>RECUERDA QUE ES OBLIGATORIO MENCIONAR DE FORMA CORRECTA Y COMPLETA EL AVISO DE PRIVACIDAD, SI ES NECESARIO DILO NUEVAMENTE</strong><br><br><label><input type="checkbox" id="ppp-chk-priv-1"> ¬øMencionaste el aviso de privacidad?</label></div>
                <div id="ppp-msg-1-no" class="system-msg msg-end" style="display:none;">[Fin de llamada]: Agradecemos su tiempo.</div>
                <button id="ppp-btn-tip-1" class="btn-action" style="display:none; background:#555;" onclick="irATipificacion('ppp')">Ir a Tipificaci√≥n</button>
            </div>
            <div id="ppp-step2" class="interaction-step">
                <div class="script-text">Sr. / Srita., mi nombre es de <span class="highlight">AFORE BANAMEX</span> el motivo de mi llamada es Informarle que en d√≠as pasados AFORE BANAMEX, recibi√≥ por parte del C. un documento...<br><br>De acuerdo a lo se√±alado en el art√≠culo 436 bis...<br><br><strong>¬øMe podrias regalar unos minutos?</strong></div>
                <div class="radio-group"><label><input type="radio" name="ppp_r2" onclick="nextStepPpp(2, true)"> S√≠</label><label><input type="radio" name="ppp_r2" onclick="nextStepPpp(2, false)"> No</label></div>
            </div>
            <div id="ppp-step2-no" class="interaction-step">
                <div class="alert-box-yellow">¬°Aviso! En <strong>AFORE BANAMEX</strong> sus datos personales est√°n protegidos...<br><br><label><input type="checkbox" id="ppp-chk-priv-2"> ¬øMencionaste el aviso de privacidad?</label></div>
                <div class="script-text">Gracias por el tiempo que dedic√≥ a esta llamada. Mi nombre es de <span class="highlight">AFORE BANAMEX</span>, que tenga buen(a) d√≠a/tarde/noche.</div>
                <button class="btn-action" onclick="irATipificacion('ppp')">Finalizar y Tipificar</button>
            </div>
            <div id="ppp-step3" class="interaction-step">
                <div class="script-text">Es mi deber informarle que esta llamada est√° siendo grabada por motivos de calidad.<br><br><strong>1) ¬øMe podr√≠a confirmar si otorgo el documento antes mencionado al trabajador , que le otorga el derecho al plan privado de pensi√≥n?</strong></div>
                <div class="radio-group"><label><input type="radio" name="ppp_r3" onclick="nextStepPpp(3, true)"> S√≠</label><label><input type="radio" name="ppp_r3" onclick="nextStepPpp(3, false)"> No</label></div>
            </div>
            <div id="ppp-step4" class="interaction-step">
                <div class="script-text"><strong>2) ¬øLa persona que firmo el documento se encuentra facultada para realizar dicha actividad?</strong></div>
                <div class="radio-group"><label><input type="radio" name="ppp_r4" onclick="nextStepPpp(4, true)"> S√≠</label><label><input type="radio" name="ppp_r4" onclick="nextStepPpp(4, false)"> No</label></div>
            </div>
            <div id="ppp-step5" class="interaction-step">
                <div class="alert-box-yellow">
                    ¬°Aviso! <br>En <strong>AFORE BANAMEX</strong> sus datos personales est√°n protegidos, consulte el aviso de privacidad en www.aforebanamex.com.mx o si lo prefiere le puedo transferir en este momento.
                    <br><br>
                    <strong>RECUERDA QUE ES OBLIGATORIO MENCIONAR DE FORMA CORRECTA Y COMPLETA EL AVISO DE PRIVACIDAD, SI ES NECESARIO DILO NUEVAMENTE</strong>
                    <br><br>
                    <label><input type="checkbox" id="ppp-chk-priv-5"> ¬øMencionaste el aviso de privacidad?</label>
                </div>
                <div class="script-text">Gracias por el tiempo que dedic√≥ a esta llamada. Mi nombre es de <span class="highlight">AFORE BANAMEX</span>, que tenga buen(a) d√≠a/tarde/noche.</div>
                <br><button class="btn-action" onclick="irATipificacion('ppp')">Finalizar y Tipificar</button>
            </div>
            <div id="ppp-step-tip" class="interaction-step" style="border-left-color: #28a745;">
                <h3 style="color:var(--bana-blue);">TIPIFICACI√ìN DEPENDENCIA</h3>
                <div class="tipif-grid">
                    <label>Calificaci√≥n:</label><select id="ppp-calif"><option>SELECCIONE</option><option>EFECTIVO</option><option>NO CONTACTO</option><option>CONTACTO NO EFECTIVO</option></select>
                    <label>SubCalificaci√≥n:</label><select id="ppp-subcalif"><option>SELECCIONE</option><option>CONFIRMA DOCUMENTO</option><option>NO CONFIRMA DOCUMENTO</option></select>
                    <label>Tipificaci√≥n:</label><select id="ppp-tipif" onchange="verificarAgenda('ppp')"><option value="">SELECCIONE</option><option value="FULL" class="opt-full">FULL - CONTACTO EXITOSO</option><option value="MED" class="opt-other">MED - Llamar despu√©s</option><option value="OCU" class="opt-other">OCU - Ocupado</option><option value="INT" class="opt-other">INT - No responde</option><option value="CEL" class="opt-other">CEL - Buz√≥n</option></select>
                    <label>Comentarios:</label><textarea id="ppp-coment"></textarea>
                </div>
                <div id="ppp-agenda" class="agenda-panel"><h4>üìÖ Agendar (MED)</h4><input type="date" id="ppp-date"> <input type="time" id="ppp-time"></div>
                <button class="btn-save" onclick="guardarInteraccion('PPP Dependencia')">GUARDAR INTERACCI√ìN</button>
            </div>
        </div>

        <div id="crm-ppt-trab" class="crm-content" style="display:none;">
            <h2 class="crm-title">PPT TRABAJADOR</h2>
            <div id="ppt-step1" class="interaction-step visible">
                <div style="margin-bottom:15px; font-weight:bold;">Ext. telef√≥nica: <input type="text" id="ppt-ext" placeholder="Ingrese Extensi√≥n" style="width:150px; padding:5px;"></div>
                <div class="script-text">Buenos D/T/N mi nombre es de <span class="highlight">AFORE BANAMEX</span>, ¬øTengo el gusto con el/la Sr./Srita. Por favor?</div>
                <div class="radio-group"><label><input type="radio" name="ppt_r1" onclick="nextStepPptTrab(1, true)"> S√≠</label><label><input type="radio" name="ppt_r1" onclick="nextStepPptTrab(1, false)"> No</label></div>
                <div class="alert-box-red" id="ppt-box-red" style="display:none;">! Recuerda que debes conseguir un "SI" textual de confirmaci√≥n...<br>1. ¬øMe puede confirmar con un "SI" o un "NO" si es usted XXXXXX?<br>2. Por protocolo de seguridad...</div>
                <div class="alert-box-yellow" id="ppt-box-yellow-no" style="display:none;">¬°Aviso! <br>En <strong>AFORE BANAMEX</strong> sus datos personales est√°n protegidos, consulte el aviso de privacidad en www.aforebanamex.com.mx o si lo prefiere le puedo transferir en este momento.<br><br><span style="color:#d9534f; font-weight:bold;">RECUERDA QUE ES OBLIGATORIO MENCIONAR DE FORMA CORRECTA Y COMPLETA EL AVISO DE PRIVACIDAD, SI ES NECESARIO DILO NUEVAMENTE</span><br><br><label><input type="checkbox" id="ppt-chk-priv-1-no"> ¬øMencionaste el aviso de privacidad?</label></div>
                <button id="ppt-btn-next-1" class="btn-action" style="display:none;" onclick="nextStepPptTrab(1, 'continuar')">Continuar</button>
            </div>
            <div id="ppt-step2" class="interaction-step">
                <div class="script-text">Sr. / Srita. mi nombre es de <span class="highlight">AFORE BANAMEX</span>, Gracias por recibir nuestra llamada... ¬øNos gustar√≠a realizarle unas preguntas sobre el servicio que recibi√≥ por parte de AFORE BANAMEX al momento de acudir a solicitar su plan privado de pensiones?<br><br><strong>¬øMe podrias regalar unos minutos?</strong></div>
                <div class="radio-group"><label><input type="radio" name="ppt_r2" onclick="nextStepPptTrab(2, true)"> S√≠</label><label><input type="radio" name="ppt_r2" onclick="nextStepPptTrab(2, false)"> No</label></div>
            </div>
            <div id="ppt-step2-no" class="interaction-step">
                <div class="alert-box-yellow">¬°Aviso! En <strong>AFORE BANAMEX</strong> sus datos personales est√°n protegidos...<br>RECUERDA QUE ES OBLIGATORIO MENCIONAR DE FORMA CORRECTA Y COMPLETA EL AVISO DE PRIVACIDAD...<br><br><label><input type="checkbox" id="ppt-chk-priv-2"> ¬øMencionaste el aviso de privacidad?</label></div>
                <button class="btn-action" onclick="irATipificacion('ppt')">Finalizar y Tipificar</button>
            </div>
            <div id="ppt-step3" class="interaction-step">
                <div class="script-text">Es mi deber informarle que esta llamada est√° siendo grabada por motivos de calidad.<br><br>Tenemos nuestros registros que en d√≠as pasados usted realiz√≥ un tr√°mite para el retiro de recursos de su Cuenta Individual al amparo de un Plan Privado de Pensiones <strong>¬øEs correcto?</strong></div>
                <div class="radio-group"><label><input type="radio" name="ppt_r3" onclick="nextStepPptTrab(3, true)"> S√≠</label><label><input type="radio" name="ppt_r3" onclick="nextStepPptTrab(3, false)"> No</label></div>
            </div>
            <div id="ppt-step4" class="interaction-step">
                <div class="script-text">Le comento que todos los tr√°mites que usted realiza en <span class="highlight">AFORE BANAMEX</span> son gratuitos, Me puede indicar <strong>¬øEn AFORE BANAMEX le pidieron o le cobraron alg√∫n Importe...?</strong></div>
                <div class="radio-group"><label><input type="radio" name="ppt_r4" onclick="nextStepPptTrab(4, true)"> S√≠</label><label><input type="radio" name="ppt_r4" onclick="nextStepPptTrab(4, false)"> No</label></div>
                <div id="ppt-monto-container" style="display:none; margin-top:10px;"><label style="font-weight:bold;">Monto:</label><input type="number" id="ppt-monto" placeholder="Ingrese el monto"></div><br><button class="btn-action" onclick="nextStepPptTrab(4, 'continuar')">Siguiente</button>
            </div>
            <div id="ppt-step5" class="interaction-step">
                <div class="script-text">Nos puede confirmar si <strong>¬øUsted desea continuar con el tr√°mite para el retiro de recursos de su Cuenta Individual al amparo de su Plan Privado de Pensiones?</strong></div>
                <div class="radio-group"><label><input type="radio" name="ppt_r5" onclick="nextStepPptTrab(5, true)"> S√≠</label><label><input type="radio" name="ppt_r5" onclick="nextStepPptTrab(5, false)"> No</label></div>
            </div>
            <div id="ppt-step6" class="interaction-step">
                <div class="alert-box-yellow">¬°Aviso! En <strong>AFORE BANAMEX</strong> sus datos personales est√°n protegidos...<br>RECUERDA QUE ES OBLIGATORIO MENCIONAR DE FORMA CORRECTA Y COMPLETA EL AVISO DE PRIVACIDAD...<br><br><label><input type="checkbox" id="ppt-chk-priv-6"> ¬øMencionaste el aviso de privacidad?</label></div>
                <button class="btn-action" onclick="irATipificacion('ppt')">Finalizar y Tipificar</button>
            </div>
            <div id="ppt-step7" class="interaction-step" style="border-left-color: #28a745;">
                <h3 style="color:var(--bana-blue);">TIPIFICACI√ìN TRABAJADOR</h3>
                <div class="tipif-grid">
                    <label>Calificaci√≥n:</label><select id="ppt-calif"><option>SELECCIONE</option><option>EFECTIVO</option><option>NO CONTACTO</option><option>CONTACTO NO EFECTIVO</option></select>
                    <label>Tipificaci√≥n:</label><select id="ppt-tipif" onchange="verificarAgenda('ppt')"><option value="">SELECCIONE</option><option value="FULL" class="opt-full">FULL - CONTACTO EXITOSO</option><option value="DTT" class="opt-dtt">DTT - Cliente no est√° interesado</option><option value="TRU" class="opt-other">TRU - Cuelga llamada</option><option value="OCU" class="opt-other">OCU - Tel√©fono ocupado</option><option value="MED" class="opt-other">MED - Llamar despu√©s</option><option value="NCO" class="opt-other">NCO - Trabajador no se encuentra</option><option value="CEL" class="opt-other">CEL - Buz√≥n</option><option value="FIN" class="opt-fin">FIN - Finado</option></select>
                    <label>Comentarios:</label><textarea id="ppt-coment"></textarea>
                </div>
                <div id="ppt-agenda" class="agenda-panel"><h4>üìÖ Agendar (MED)</h4><input type="date" id="ppt-date"> <input type="time" id="ppt-time"></div>
                <button class="btn-save" onclick="guardarInteraccion('PPT Trabajador')">GUARDAR INTERACCI√ìN</button>
            </div>
        </div>

        <div id="crm-notiafo" class="crm-content" style="display:none;">
            <h2 class="crm-title">NOTIAFO CRM</h2>
            <div id="not-step1" class="interaction-step visible">
                <div class="script-text">Buenos D/T/N mi nombre es de <span class="highlight">AFORE BANAMEX</span>, ¬øTengo el gusto con el/la Sr. / Srita. Por favor?</div>
                <div class="radio-group"><label><input type="radio" name="not_r1" onclick="nextStepNotiafo(1, true)"> S√≠</label><label><input type="radio" name="not_r1" onclick="nextStepNotiafo(1, false)"> No</label></div>
                <div class="alert-box-red" id="not-red-alert" style="display:none;">! Recuerda que debes conseguir un "SI" textual de confirmaci√≥n...<br>1. ¬øMe puede confirmar con un "SI" o un "NO" si es usted XXXXXX?</div>
                <div id="not-step1-no" style="display:none;"><div class="alert-box-yellow">¬°Aviso!<br>En CITIBANAMEX AFORE sus datos personales est√°n protegidos...<br><strong>RECUERDA QUE ES OBLIGATORIO MENCIONAR...</strong><br><br><label><input type="checkbox" id="not-chk-priv-1"> ¬øMencionaste el aviso de privacidad?</label></div><div class="script-text">Gracias por el tiempo que dedic√≥ a esta llamada...</div><button class="btn-action" onclick="irATipificacion('not')">Ir a Tipificaci√≥n</button></div>
                <button id="not-btn-cont-1" class="btn-action" style="display:none;" onclick="nextStepNotiafo(1, 'continuar')">Continuar</button>
            </div>
            <div id="not-step2" class="interaction-step">
                <div class="script-text">Sr. / Srita., mi nombre es de CITIBANAMEX AFORE... Le informamos que los datos que tenemos registrados en esta Administradora difieren de los datos que reporta el Instituto (IMSS)...<br><br>Es mi deber informarle que esta llamada est√° siendo grabada por motivos de calidad.<br><br><strong>¬øMe puede proporcionar su Nombre completo, RFC o su n√∫mero telef√≥nico, por favor?</strong></div>
                <div style="margin-top:10px;"><label>Nombre Completo:</label> <input type="text" id="not-nombre"><br><label>RFC:</label> <input type="text" id="not-rfc"><br><label>Numero Telefonico:</label> <input type="text" id="not-tel"></div>
                <div class="radio-group" style="margin-top:15px;"><label><input type="radio" name="not_r2" onclick="nextStepNotiafo(2, true)"> S√≠</label><label><input type="radio" name="not_r2" onclick="nextStepNotiafo(2, false)"> No</label></div>
            </div>
            <div id="not-step2-obj" class="interaction-step">
                <div class="script-text" style="color:#d9534f; font-weight:bold;">Le informo que por disposici√≥n oficial es indispensable que Usted nos confirme por lo menos uno de sus datos para poder continuar con el proceso, ¬øEst√° Usted de acuerdo?</div>
                <div class="radio-group"><label><input type="radio" name="not_r2b" onclick="nextStepNotiafo('2b', true)"> S√≠</label><label><input type="radio" name="not_r2b" onclick="nextStepNotiafo('2b', false)"> No</label></div>
            </div>
            <div id="not-step3" class="interaction-step">
                <div class="script-text">Lo invitamos a que acuda a cualquiera de los M√≥dulos Especializados de Servicio Afore o Centro de Atenci√≥n para el Retiro (CARE), presentando original de los siguientes documentos:<ul><li>Identificaci√≥n Oficial</li><li>Comprobante de Domicilio</li><li>Acta y CURP</li><li>Documento Migratorio (FM3 √≥ FM2)</li></ul></div>
                <button class="btn-action" onclick="nextStepNotiafo(3, 'continuar')">Continuar al Cierre</button>
            </div>
            <div id="not-step4" class="interaction-step">
                <div class="alert-box-yellow">¬°Aviso!<br>En CITIBANAMEX AFORE sus datos personales est√°n protegidos...<br><br><strong>RECUERDA QUE ES OBLIGATORIO MENCIONAR...</strong><br><br><label><input type="checkbox" id="not-chk-priv-end"> ¬øMencionaste el aviso de privacidad?</label></div>
                <button class="btn-action" onclick="irATipificacion('not')">Finalizar y Tipificar</button>
            </div>
            <div id="not-step-tip" class="interaction-step" style="border-left-color: #28a745;">
                <h3 style="color:var(--bana-blue);">TIPIFICACI√ìN NOTIAFO</h3>
                <div class="tipif-grid">
                    <label>Calificaci√≥n:</label><select id="not-calif"><option>SELECCIONE</option><option>EFECTIVO</option><option>NO CONTACTO</option><option>CONTACTO NO EFECTIVO</option></select>
                    <label>SubCalificaci√≥n:</label><select id="not-subcalif"><option>SELECCIONE</option><option>CONFIRMACI√ìN DE CLIENTE PARA ACUDIR AL CARE</option><option>Cliente no est√° interesado</option><option>Datos no coinciden</option></select>
                    <label>Tipificaci√≥n (Agenda):</label><select id="not-tipif" onchange="verificarAgenda('not')"><option value="">SELECCIONE</option><option value="FULL">FULL - COMPLETADO</option><option value="MED">MED - Llamar despu√©s</option></select>
                    <label>Comentarios:</label><textarea id="not-coment"></textarea>
                </div>
                <div id="not-agenda" class="agenda-panel"><h4>üìÖ Agendar (MED)</h4><input type="date" id="not-date"> <input type="time" id="not-time"></div>
                <button class="btn-save" onclick="guardarInteraccion('NOTIAFO')">GUARDAR INTERACCI√ìN</button>
            </div>
        </div>

        <div id="crm-portal" class="crm-content" style="display:none;">
            <h2 class="crm-title">PORTAL PROSPECTOS</h2>
            <div id="por-step1" class="interaction-step visible">
                <div style="margin-bottom:15px; font-weight:bold;">Ext. telef√≥nica: <input type="text" id="por-ext" placeholder="Ingrese Extensi√≥n" style="width:150px;"></div>
                <div class="script-text">Buenos D/T/N mi nombre es de <span class="highlight">AFORE BANAMEX</span>, ¬øTengo el gusto con el/la Sr./Srita. Por favor?</div>
                <div class="radio-group"><label><input type="radio" name="por_r1" onclick="nextStepPortal(1, true)"> S√≠</label><label><input type="radio" name="por_r1" onclick="nextStepPortal(1, false)"> No</label></div>
                <div class="alert-box-red" id="por-red-alert" style="display:none;">! Recuerda que debes conseguir un "SI" textual de confirmaci√≥n...</div>
                <div id="por-step1-no" style="display:none;"><div class="alert-box-yellow">¬°Aviso! En AFORE BANAMEX...<br>RECUERDA QUE ES OBLIGATORIO...<br><label><input type="checkbox"> ¬øMencionaste el aviso?</label></div><button class="btn-action" onclick="irATipificacion('por')">Ir a Tipificaci√≥n</button></div>
                <button id="por-btn-cont-1" class="btn-action" style="display:none;" onclick="nextStepPortal(1, 'continuar')">Continuar</button>
            </div>
            <div id="por-step2" class="interaction-step">
                <div class="script-text">Sr. /Srita. (), como le comentaba, mi nombre es (), me comunico de <span class="highlight">AFORE BANAMEX</span>, el motivo de mi llamada es confirmar la solicitud de cambio de Afore que realiz√≥ recientemente a trav√©s de nuestro portal web. ¬øEs correcto?</div>
                <div class="radio-group"><label><input type="radio" name="por_r2" onclick="nextStepPortal(2, true)"> S√≠</label><label><input type="radio" name="por_r2" onclick="nextStepPortal(2, false)"> No</label></div>
            </div>
            <div id="por-step3" class="interaction-step">
                <div class="script-text">En <span class="highlight">AFORE BANAMEX</span> sus datos est√°n protegidos... Le informo que esta llamada est√° siendo grabada por motivos de calidad, ¬øest√° de acuerdo en que sigamos con la misma para brindarle informaci√≥n?</div>
                <div class="radio-group"><label><input type="radio" name="por_r3" onclick="nextStepPortal(3, true)"> S√≠</label><label><input type="radio" name="por_r3" onclick="nextStepPortal(3, false)"> No</label></div>
            </div>
            <div id="por-step4" class="interaction-step">
                <div class="script-text">Nuestro proceso de cambio de Afore, es presencial y personalizado, por lo que es necesario programar una cita con uno de nuestros asesores previsionales ya sea en alguna de nuestras sucursales o en su oficina/domicilio.</div>
                <div style="display:flex; gap:20px; margin-top:15px;"><button class="btn-action" style="background:#002D72;" onclick="nextStepPortal(4, 'sucursal')">Sucursal</button><button class="btn-action" style="background:#002D72;" onclick="nextStepPortal(4, 'visita')">Visita</button></div>
            </div>
            <div id="por-step-sucursal" class="interaction-step">
                <div class="script-text"><strong>‚Ä¢ Sucursal:</strong> ¬øSabe a qu√© sucursal desea asistir o si me proporciona su c√≥digo postal o municipio puedo ofrecerle las opciones m√°s cercanas?</div>
                <div style="margin-top:10px;"><label>Sucursal Agendada:</label> <input type="text" id="por-sucursal-nom"></div>
                <button class="btn-action" onclick="nextStepPortal('sucursal', 'fin')">Finalizar Agendamiento</button>
            </div>
            <div id="por-step-visita" class="interaction-step">
                <div class="script-text"><strong>‚Ä¢ Visita:</strong> ¬øPodr√≠a indicarme la direcci√≥n en la cu√°l recibir√° al asesor?</div>
                <div class="form-grid-3"><div><label>Calle:</label><input type="text" id="por-calle"></div><div><label>CP:</label><input type="text" id="por-cp"></div><div><label>Colonia:</label><input type="text" id="por-colonia"></div><div><label>Alcald√≠a:</label><input type="text" id="por-alcaldia"></div><div><label>Estado:</label><input type="text" id="por-estado"></div><div><label>Referencias:</label><input type="text" id="por-ref"></div><div><label>Tel:</label><input type="text" id="por-tel"></div><div><label>Email:</label><input type="text" id="por-email"></div></div>
                <div style="margin-top:15px;"><label>Fecha:</label> <input type="date" id="por-cita-date"><label>Hora:</label> <select id="por-cita-time"><option>8:00 AM</option><option>12:00 PM</option><option>4:00 PM</option></select></div>
                <div style="color:red; font-size:0.9rem; margin-top:10px; font-weight:bold;">Para poder realizar su tr√°mite necesitar√° su Credencial de Elector vigente...</div>
                <button class="btn-action" onclick="nextStepPortal('visita', 'fin')">Finalizar Agendamiento</button>
            </div>
            <div id="por-step-end" class="interaction-step">
                <div class="alert-box-yellow">RECUERDA QUE ES OBLIGATORIO MENCIONAR...<br><label><input type="checkbox"> ¬øMencionaste el aviso?</label></div>
                <button class="btn-action" onclick="irATipificacion('por')">Ir a Tipificaci√≥n</button>
            </div>
            <div id="por-step-tip" class="interaction-step" style="border-left-color: #28a745;"><h3>TIPIFICACI√ìN PORTAL</h3><div class="tipif-grid"><label>Tipificaci√≥n:</label><select id="por-tipif" onchange="verificarAgenda('por')"><option>FULL-R</option><option>FULL-S</option><option>MED</option></select><label>Comentarios:</label><textarea id="por-coment"></textarea></div><div id="por-agenda" class="agenda-panel"><input type="date" id="por-date"><input type="time" id="por-time"></div><button class="btn-save" onclick="guardarInteraccion('Portal')">GUARDAR</button></div>
        </div>

        <div id="crm-confout" class="crm-content" style="display:none;">
            <h2 class="crm-title">CONFIRMACI√ìN OUT</h2>
            <div id="out-step1" class="interaction-step visible">
                <div class="script-text">Buenos D/T/N mi nombre es , llamamos de <span class="highlight">AFORE BANAMEX</span>, ¬øTengo el gusto con el/la Sr. / Srita Por favor?.</div>
                <div class="radio-group"><label><input type="radio" name="out_r1" onclick="nextStepOut(1, true)"> S√≠</label><label><input type="radio" name="out_r1" onclick="nextStepOut(1, false)"> No</label></div>
                
                <div class="alert-box-red">
                    ! Recuerda que debes conseguir un "SI" textual de confirmaci√≥n por parte del cliente.<br>
                    1. ¬øMe puede confirmar con un "SI" o un "NO" si es usted XXXXXX?<br>
                    2. Por protocolo de seguridad, ¬øMe puede confirmar con un "SI" o un "NO" si es usted XXXXXX?
                </div>

                <div id="out-conocido-panel" style="display:none; margin-top:15px; border-top:1px dashed #ccc; padding-top:10px;">
                    <p style="font-weight:bold;">¬øUsted conoce al Sr/sra?</p>
                    <div class="radio-group"><label><input type="radio" name="out_r_conoce" onclick="manejarConocido(true)"> S√≠</label><label><input type="radio" name="out_r_conoce" onclick="manejarConocido(false)"> No</label></div>
                </div>
                
                <div id="out-no-conoce-msg" class="system-msg msg-end" style="display:none;">Muchas gracias por la informaci√≥n hasta luego.<br><button class="btn-action" onclick="irATipificacion('out')">Finalizar (EQU)</button></div>
                <div id="out-conoce-agenda" class="agenda-panel"><p>Validaremos si es posible contactarlo m√°s tarde. Por favor agende:</p><label>Fecha:</label> <input type="date" id="out-date-conoce"><label>Hora:</label> <input type="time" id="out-time-conoce"><br><br><button class="btn-save" onclick="guardarInteraccion('Confirmaci√≥n OUT - Agenda')">Agendar Segunda Llamada</button></div>
            </div>
            <div id="out-step2" class="interaction-step">
                <div class="script-text">Es mi deber informarle que esta llamada est√° siendo grabada por motivos de calidad. Sr. /Srita. , para Citibanamex Afore es un gusto recibir su solicitud de cambio de afore.<br><br>¬øSab√≠a qu√© en los √∫ltimos 3 a√±os, m√°s de un mill√≥n de clientes se cambiaron a Citibanamex Afore?, usted tambi√©n puede ser parte de Citibanamex Afore integrante de uno de los grupos financieros m√°s s√≥lidos del mercado.<br><br>El motivo de mi llamada es apoyarle en c√≥mo confirmar y concluir su tr√°mite, este proceso nos llevar√° solamente <strong>2 minutos</strong>, le comento que es muy importante realizar este paso, debido a que tenemos pocos d√≠as para realizarlo, <strong>¬øMe permite continuar?</strong></div>
                <div class="radio-group"><label><input type="radio" name="out_r2" onclick="nextStepOut(2, true)"> S√≠</label><label><input type="radio" name="out_r2" onclick="nextStepOut(2, false)"> No</label></div>
                <div id="out-no-tiempo-panel" style="display:none; margin-top:15px; padding-top:10px;"><p>Entiendo, esta llamada es muy importante... <strong>¬øEn qu√© momento desea que le llamemos?</strong></p><div class="radio-group"><label><input type="radio" name="out_r_tiempo" onclick="nextStepOut(2, true)"> Continuar ahora</label><label><input type="radio" name="out_r_tiempo" onclick="document.getElementById('out-agenda-step2').style.display='block'"> Llamar de nuevo</label></div><div id="out-agenda-step2" class="agenda-panel"><label>Fecha:</label><input type="date" id="out-date-step2"><label>Hora:</label><input type="time" id="out-time-step2"><button class="btn-save" onclick="guardarInteraccion('Confirmaci√≥n OUT - Agenda')">Agendar</button></div></div>
            </div>
            <div id="out-step3" class="interaction-step">
                <div class="script-text">Gracias, por favor:<ol><li>Ingrese a la bandeja de entrada de sus Mensajes o SMS en su tel√©fono celular.</li><li>Identifique el mensaje con el nombre AFORE</li><li>√Åbralo y haga clic en la liga que aparece en el mensaje. En este momento ser√° redireccionado a la p√°gina web del Sistema de Ahorro para el Retiro.</li><li>Una vez que se encuentre en la p√°gina web, seleccione el bot√≥n ‚Äúcontinuar tr√°mite‚Äù.</li><li>En la siguiente pantalla le pedir√° que ingrese un c√≥digo de seguridad de 4 d√≠gitos el cu√°l fue enviado a su correo electr√≥nico y tendr√° una vigencia de 3 minutos.</li><li>Ingrese su c√≥digo de seguridad en la pantalla y seleccione ‚ÄúCONTINUAR‚Äù.</li><li>Por √∫ltimo, le aparecer√° en pantalla la leyenda ‚ÄúTu solicitud se confirm√≥ con √©xito‚Äù.</li></ol><br><strong>¬°Felicidades!, su proceso de cambio a Citibanamex Afore continua, agradecemos su preferencia.</strong></div>
                <div style="margin-top:20px; border-top:1px dashed #ccc; padding-top:15px;">
                    <p><strong>Despedida y Referencias:</strong><br>Por √∫ltimo, me puede proporcionar el nombre de 2 referencias para poder ofrecerles una Asesor√≠a Previsional de su Afore.<br><em>En caso de que no te proporcione alg√∫n nombre, agradece y continua la llamada. Si te proporciona alguna referencia, docum√©ntalas y continua la llamada.</em></p>
                    <div class="form-grid-3"><div><label>Nombre Referencia 1:</label><input type="text" id="out-ref1"></div><div><label>Nombre Referencia 2:</label><input type="text" id="out-ref2"></div></div>
                </div>
                <button class="btn-action" onclick="nextStepOut(3, 'continuar')">Finalizar</button>
            </div>
            
            <div id="out-step-end" class="interaction-step">
                <div class="alert-box-yellow">
                    <strong>RECUERDA QUE ES OBLIGATORIO MENCIONAR DE FORMA CORRECTA Y COMPLETA EL AVISO DE PRIVACIDAD, SI ES NECESARIO DILO NUEVAMENTE</strong>
                    <br><br>
                    Aviso de privacidad
                    <br>
                    Sr./Srita. , le agradecemos nos haya tomado la llamada, le atendi√≥ de Afore Banamex, que pase buen (a) D/T/N. Le recordamos que puede comunicarse a nuestro Centro de Atenci√≥n Telef√≥nica al 55 22 62 36 73 de lunes a s√°bado de 8:00 am a 8:00 pm., sin costo desde todo el pa√≠s, en donde con gusto le atenderemos. Por √∫ltimo tambi√©n le informo que en CITIBANAMEX AFORE sus datos personales est√°n protegidos, puede consultar nuestro aviso de privacidad en www.aforebanamex.com.mx o bien si Usted as√≠ lo desea, en este momento lo puedo transferir para que escuche nuestro Aviso de Privacidad, ¬ødesea escucharlo?
                    <br><br>
                    <label><input type="checkbox"> ¬øMencionaste el aviso de privacidad?</label>
                </div>
                <div class="script-text">Le atendi√≥ de <span class="highlight">AFORE BANAMEX</span> que pase buen d√≠a/tardes/noches.</div>
                <button class="btn-action" onclick="irATipificacion('out')">Ir a Tipificaci√≥n</button>
            </div>

            <div id="out-step-tip" class="interaction-step" style="border-left-color: #28a745;">
                <h3 style="color:var(--bana-blue);">TIPIFICACI√ìN CONFIRMACI√ìN OUT</h3>
                <div class="tipif-grid">
                    <label>Calificaci√≥n:</label><select id="out-calif"><option>SELECCIONE</option><option>CONTACTO EXITOSO</option><option>CONTACTO NO EXITOSO</option></select>
                    <label>Tipificaci√≥n:</label>
                    <select id="out-tipif" onchange="verificarAgenda('out')">
                        <option value="">SELECCIONE</option>
                        <option value="FULL-1" class="opt-full">FULL - LLAMADA EXITOSA TRABAJADOR LOCALIZADO CON SCRIPT (CONFIRMA TRASPASO)</option>
                        <option value="FULL-2" class="opt-full">FULL - LLAMADA EXITOSA TRABAJADOR LOCALIZADO CON SCRIPT (CONFIRMA, PROBLEMAS CON EL SMS)</option>
                        <option value="FULL-3" class="opt-full">FULL - LLAMADA EXITOSA TRABAJADOR LOCALIZADO CON SCRIPT ( NO CONFIRMA TRASPASO)</option>
                        <option value="TRU" class="opt-other">TRU - Cuelga llamada, cortada</option>
                        <option value="CEL" class="opt-other">CEL - Fuera de servicio & Buz√≥n de voz</option>
                        <option value="OCU" class="opt-other">OCU - Tel√©fono ocupado</option>
                        <option value="INT" class="opt-other">INT - Suena de 1 a 5 veces y no responde</option>
                        <option value="MED" class="opt-other">MED - Trabajador no contesta el script, pide se le llame despu√©s</option>
                        <option value="NCO" class="opt-other">NCO - Trabajador no se encuentra</option>
                        <option value="NCA" class="opt-other">NCA - El apoderado no se encuentra</option>
                        <option value="DNC" class="opt-other">DNC - Datos no coinciden</option>
                        <option value="REC" class="opt-red">REC - El trabajador contesta y no reconoce haber realizado el tr√°mite...</option>
                        <option value="EQU" class="opt-red">EQU - No conocen al trabajador</option>
                        <option value="TMO" class="opt-red">TMO - Cliente molesto, no est√° interesado...</option>
                        <option value="FIN" class="opt-fin">FIN - Finado</option>
                        <option value="DTT" class="opt-dtt">DTT - Cliente no est√° interesado en recibir informaci√≥n</option>
                    </select>
                    <label>Comentarios:</label><textarea id="out-coment"></textarea>
                </div>
                <div id="out-agenda" class="agenda-panel"><h4>üìÖ Agendar (MED)</h4><input type="date" id="out-date"> <input type="time" id="out-time"></div>
                <button class="btn-save" onclick="guardarInteraccion('Confirmaci√≥n OUT')">GUARDAR INTERACCI√ìN</button>
            </div>
        </div>

        <div id="crm-placeholder" class="crm-content" style="display:none; padding:40px; text-align:center;"><h3>Este flujo a√∫n no ha sido cargado.</h3><p>Selecciona un flujo de la botonera.</p></div>

    </div>
</div>

<script type="module">
    // -----------------------------------------------------------
    // CONFIGURACI√ìN FIREBASE
    // -----------------------------------------------------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Credenciales extra√≠das de tu imagen image_c6acda.png
    const firebaseConfig = {
        apiKey: "AIzaSyB3u2oa5EZ3l37dVkzYAG75aumn4PHlJfk",
        authDomain: "banamex-772ea.firebaseapp.com",
        projectId: "banamex-772ea",
        storageBucket: "banamex-772ea.firebasestorage.app",
        messagingSenderId: "1040835829601",
        appId: "1:1040835829601:web:4422a8f359d9c85dc3af20",
        measurementId: "G-Q66VLWPKJE"
    };

    // Inicializar Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let currentAgentID = "";
    let historialInteracciones = JSON.parse(localStorage.getItem('crm_pentafon_db')) || [];

    // --- LOGIN ---
    window.iniciarSesion = function() {
        const id = document.getElementById('empleado-id').value;
        if(id.trim() === "") {
            document.getElementById('login-error').style.display = 'block';
            return;
        }
        currentAgentID = id;
        document.getElementById('display-agente').innerText = "Agente: " + id;
        document.getElementById('login-overlay').style.display = 'none';
        document.getElementById('main-app').style.display = 'block';
    }

    // --- NAVEGACION ---
    window.cargarCRM = function(id) {
        document.querySelectorAll('.btn-nav').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        document.querySelectorAll('.crm-content').forEach(div => div.style.display = 'none');
        const map = {'enrolamiento':'crm-enrolamiento','ppp-dep':'crm-ppp-dep','ppt-trab':'crm-ppt-trab','notiafo':'crm-notiafo','portal':'crm-portal','confout':'crm-confout'};
        if(map[id]) document.getElementById(map[id]).style.display = 'block';
        else document.getElementById('crm-placeholder').style.display = 'block';
    }

    // --- ENROLAMIENTO ---
    window.nextStepEnr = function(paso, val) {
        if(paso===1) { if(val) {reveal('enr-step2');hide('enr-msg-1-no');hide('enr-btn-tip-1');} else {show('enr-msg-1-no');show('enr-btn-tip-1');hide('enr-step2');} }
        if(paso===2) { if(val==='si') show('enr-msg-privacy'); else hide('enr-msg-privacy'); reveal('enr-step3'); }
        if(paso===3) { if(val) {reveal('enr-step4');hide('enr-opciones-container');} else {show('enr-opciones-container');hide('enr-step4');} }
        if(paso===5) { if(val===true) {hide('enr-huellas-no');reveal('enr-step6');} else if(val===false) {show('enr-huellas-no');hide('enr-step6');} else {reveal('enr-step6');} }
    }
    window.validarDatosEnr = function(){ const n=getVal('enr-val-nombre'),t=getVal('enr-val-tel'),c=getVal('enr-val-curp'); if(n==="CORRECTO"||t==="CORRECTO"||c==="CORRECTO"){hide('enr-error-val');reveal('enr-step5');}else show('enr-error-val'); }

    // --- PPP ---
    window.nextStepPpp = function(paso, val) {
        if(paso===1) { if(val) {reveal('ppp-step2');hide('ppp-msg-1-no');hide('ppp-btn-tip-1');} else {show('ppp-msg-1-no');show('ppp-btn-tip-1');hide('ppp-step2');} }
        if(paso===2) { if(val) {reveal('ppp-step3');hide('ppp-step2-no');} else {reveal('ppp-step2-no');hide('ppp-step3');} }
        if(paso===3) reveal('ppp-step4');
        if(paso===4) reveal('ppp-step5');
    }

    // --- PPT ---
    window.nextStepPptTrab = function(paso, val) {
        if(paso===1) {
            if(val===true) { show('ppt-box-red');show('ppt-btn-next-1');hide('ppt-box-yellow-no'); }
            else if(val===false) { show('ppt-box-red');show('ppt-box-yellow-no');hide('ppt-btn-next-1');irATipificacion('ppt'); }
            else { reveal('ppt-step2'); }
        }
        if(paso===2) { if(val) {reveal('ppt-step3');hide('ppt-step2-no');} else {reveal('ppt-step2-no');hide('ppt-step3');} }
        if(paso===3) reveal('ppt-step4');
        if(paso===4) { if(val===true) show('ppt-monto-container'); else hide('ppt-monto-container'); if(val==='continuar') reveal('ppt-step5'); }
        if(paso===5) reveal('ppt-step6');
    }

    // --- NOTIAFO ---
    window.nextStepNotiafo = function(paso, val) {
        if(paso===1) { if(val===true) {show('not-red-alert');show('not-btn-cont-1');hide('not-step1-no');} else if(val===false) {show('not-red-alert');hide('not-btn-cont-1');show('not-step1-no');} else reveal('not-step2'); }
        if(paso===2) { if(val===true) {reveal('not-step3');hide('not-step2-obj');} else {reveal('not-step2-obj');hide('not-step3');} }
        if(paso==='2b') { if(val===true) reveal('not-step3'); else {reveal('not-step4');hide('not-step3');} }
        if(paso===3) reveal('not-step4');
    }

    // --- PORTAL ---
    window.nextStepPortal = function(paso, val) {
        if(paso===1) { if(val===true) {show('por-red-alert');show('por-btn-cont-1');hide('por-step1-no');} else if(val===false) {show('por-red-alert');hide('por-btn-cont-1');show('por-step1-no');} else reveal('por-step2'); }
        if(paso===2) { if(val===true) reveal('por-step3'); else reveal('por-step-end'); }
        if(paso===3) { if(val===true) reveal('por-step4'); else reveal('por-step-end'); }
        if(paso===4) { if(val==='sucursal') {reveal('por-step-sucursal');hide('por-step-visita');} if(val==='visita') {reveal('por-step-visita');hide('por-step-sucursal');} }
        if(paso==='sucursal'||paso==='visita') reveal('por-step-end');
    }

    // --- OUT ---
    window.nextStepOut = function(paso, val) {
        if(paso===1) { if(val===true) {reveal('out-step2');hide('out-conocido-panel');hide('out-no-conoce-msg');hide('out-conoce-agenda');} else show('out-conocido-panel'); }
        if(paso===2) { if(val===true) {reveal('out-step3');hide('out-no-tiempo-panel');} else show('out-no-tiempo-panel'); }
        if(paso===3) reveal('out-step-end');
    }
    window.manejarConocido = function(conoce) { if(conoce) {hide('out-no-conoce-msg');show('out-conoce-agenda');} else {hide('out-conoce-agenda');show('out-no-conoce-msg');} }

    // --- COMMON ---
    window.irATipificacion = function(flujo) { const m={'enr':'enr-step7','ppp':'ppp-step-tip','ppt':'ppt-step7','not':'not-step-tip','por':'por-step-tip','out':'out-step-tip'}; if(m[flujo]) reveal(m[flujo]); }
    window.verificarAgenda = function(flujo) { const s=document.getElementById(flujo+'-tipif').value,p=document.getElementById(flujo+'-agenda'); if(p) p.style.display=s.includes("MED")?'block':'none'; }
    
    // --- GUARDAR (FIREBASE + LOCAL) ---
    window.guardarInteraccion = async function(nf) {
        let pf=''; if(nf.includes('Enrolamiento')) pf='enr'; if(nf.includes('PPP')) pf='ppp'; if(nf.includes('PPT')) pf='ppt'; if(nf.includes('NOTIAFO')) pf='not'; if(nf.includes('Portal')) pf='por'; if(nf.includes('OUT')||nf.includes('Agenda')) pf='out';
        
        // Objeto Base
        let reg = { 
            "Agente": currentAgentID,
            "Fecha": new Date().toLocaleDateString(), 
            "Hora": new Date().toLocaleTimeString(), 
            "Flujo": nf 
        };

        // L√≥gica Agenda Directa
        if(nf.includes('Agenda')) {
            reg["Calificaci√≥n"] = "N/A"; 
            reg["Tipificaci√≥n"] = "MED - Agendado en llamada"; 
            reg["Cita Fecha"] = document.getElementById(pf+'-date-conoce').value||document.getElementById(pf+'-date-step2').value;
            reg["Cita Hora"] = document.getElementById(pf+'-time-conoce').value||document.getElementById(pf+'-time-step2').value;
        } else {
            reg["Calificaci√≥n"] = document.getElementById(pf+'-calif').value;
            reg["Tipificaci√≥n"] = document.getElementById(pf+'-tipif').value;
            reg["Comentarios"] = document.getElementById(pf+'-coment').value;
            const d=document.getElementById(pf+'-date'); if(d) reg["Cita Fecha"]=d.value;
            const t=document.getElementById(pf+'-time'); if(t) reg["Cita Hora"]=t.value;
        }

        // Guardar en LocalStorage (Backup)
        historialInteracciones.push(reg);
        localStorage.setItem('crm_pentafon_db', JSON.stringify(historialInteracciones));

        // Guardar en Firebase
        try {
            await addDoc(collection(db, "registros"), reg);
            alert("‚úÖ Guardado en Base de Datos");
        } catch (e) {
            console.error("Error al guardar en Firebase: ", e);
            alert("‚ö†Ô∏è Guardado localmente (Error de conexi√≥n)");
        }
        
        location.reload();
    }

    window.descargarExcel = function() {
        if(historialInteracciones.length===0){alert("Sin datos");return;}
        const ws=XLSX.utils.json_to_sheet(historialInteracciones);
        const wb=XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb,ws,"Reporte");
        XLSX.writeFile(wb,"Reporte_Afore.xlsx");
    }

    // UTILS
    function show(id){document.getElementById(id).style.display='block';}
    function hide(id){document.getElementById(id).style.display='none';}
    function reveal(id){document.getElementById(id).classList.add('visible');document.getElementById(id).style.display='block';document.getElementById(id).scrollIntoView({behavior:"smooth"});}
    function getVal(id){return document.getElementById(id).value;}

    // Init
    document.getElementById('crm-enrolamiento').style.display='block';
    if(document.getElementById('enr-step1')) document.getElementById('enr-step1').classList.add('visible');
</script>
</body>
</html>
